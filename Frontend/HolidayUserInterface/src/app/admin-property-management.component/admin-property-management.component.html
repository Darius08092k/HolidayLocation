<div class="admin-container">
  <!-- Navigation component -->
  <nav aria-label="Navigation" class="navigation-container">
    <ul class="pagination pagination-sm">
      <li class="page-item">
        <a class="page-link" routerLink="/admin/accounts">Account Management</a>
      </li>
      <li class="page-item active">
        <a class="page-link" routerLink="/admin/properties" aria-current="page">Property Management</a>
      </li>
      <li class="page-item">
        <a class="page-link" routerLink="/admin/bookings">Booking Management</a>
      </li>
    </ul>
  </nav>

  <h2>Property Management</h2>

  <div class="table-wrapper">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th scope="col">Name</th>
          <th scope="col">Rate</th>
          <th scope="col">Occupancy</th>
          <th scope="col">Sqft</th>
          <th scope="col">Amenity</th>
          <th scope="col" class="actions-column">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of properties">
          <td>{{ p.name }}</td>
          <td>${{ p.rate }}</td>
          <td>{{ p.occupancy }} guests</td>
          <td>{{ p.sqft }} sqft</td>
          <td>{{ p.amenity || '-' }}</td>
          <td class="actions-column">
            <button class="btn btn-edit" (click)="openEditModal(p)" title="Edit property">
              Edit
            </button>
            <button class="btn btn-delete" (click)="deleteProperty(p)" title="Delete property">
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="properties.length === 0" class="no-data">
      No properties found.
    </div>
  </div>

  <div class="add-button-container">
    <button class="btn btn-primary btn-add" (click)="openCreateModal()" title="Add new property">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
      </svg>
      <span>Add New Property</span>
    </button>
  </div>
</div>

<!-- Modal Backdrop -->
<div class="modal-backdrop"
     *ngIf="isEditModalVisible"
     (click)="closeEditModal()">
</div>

<!-- Edit Property Modal Container -->
<div class="modal-container"
     *ngIf="isEditModalVisible"
     (click)="$event.stopPropagation()">

  <div class="modal-header">
    <h2 class="modal-title">Edit Property</h2>
    <button class="close-button"
            (click)="closeEditModal()"
            aria-label="Close">
      <span>&times;</span>
    </button>
  </div>

  <div class="modal-body">
    <form class="edit-property-form">
      <div class="form-group">
        <label for="editName">Property Name *</label>
        <input
          type="text"
          id="editName"
          class="form-control"
          [(ngModel)]="editName"
          name="editName"
          required>
      </div>

      <div class="form-group">
        <label for="editDetails">Details</label>
        <textarea
          id="editDetails"
          class="form-control"
          [(ngModel)]="editDetails"
          name="editDetails"
          rows="3"></textarea>
      </div>

      <div class="form-group">
        <label for="editRate">Rate (per night) *</label>
        <input
          type="number"
          id="editRate"
          class="form-control"
          [(ngModel)]="editRate"
          name="editRate"
          required>
      </div>

      <div class="form-group">
        <label for="editOccupancy">Occupancy (guests) *</label>
        <input
          type="number"
          id="editOccupancy"
          class="form-control"
          [(ngModel)]="editOccupancy"
          name="editOccupancy"
          required>
      </div>

      <div class="form-group">
        <label for="editSqft">Square Feet *</label>
        <input
          type="number"
          id="editSqft"
          class="form-control"
          [(ngModel)]="editSqft"
          name="editSqft"
          required>
      </div>

      <div class="form-group">
        <label for="editImageUrl">Image URL</label>
        <input
          type="text"
          id="editImageUrl"
          class="form-control"
          [(ngModel)]="editImageUrl"
          name="editImageUrl">
      </div>

      <div class="form-group">
        <label for="editAmenity">Amenity</label>
        <input
          type="text"
          id="editAmenity"
          class="form-control"
          [(ngModel)]="editAmenity"
          name="editAmenity">
      </div>
    </form>
  </div>

  <div class="modal-footer">
    <button class="btn btn-secondary" (click)="closeEditModal()">
      Cancel
    </button>
    <button class="btn btn-primary" (click)="saveProperty()">
      Save Changes
    </button>
  </div>
</div>

<!-- Create Property Modal Backdrop -->
<div class="modal-backdrop"
     *ngIf="isCreateModalVisible"
     (click)="closeCreateModal()">
</div>

<!-- Create Property Modal Container -->
<div class="modal-container"
     *ngIf="isCreateModalVisible"
     (click)="$event.stopPropagation()">

  <div class="modal-header">
    <h2 class="modal-title">Create New Property</h2>
    <button class="close-button"
            (click)="closeCreateModal()"
            aria-label="Close">
      <span>&times;</span>
    </button>
  </div>

  <div class="modal-body">
    <form class="create-property-form">
      <div class="form-group">
        <label for="newName">Property Name *</label>
        <input
          type="text"
          id="newName"
          class="form-control"
          [(ngModel)]="newName"
          name="newName"
          required>
      </div>

      <div class="form-group">
        <label for="newDetails">Details</label>
        <textarea
          id="newDetails"
          class="form-control"
          [(ngModel)]="newDetails"
          name="newDetails"
          rows="3"></textarea>
      </div>

      <div class="form-group">
        <label for="newRate">Rate (per night) *</label>
        <input
          type="number"
          id="newRate"
          class="form-control"
          [(ngModel)]="newRate"
          name="newRate"
          required>
      </div>

      <div class="form-group">
        <label for="newOccupancy">Occupancy (guests) *</label>
        <input
          type="number"
          id="newOccupancy"
          class="form-control"
          [(ngModel)]="newOccupancy"
          name="newOccupancy"
          required>
      </div>

      <div class="form-group">
        <label for="newSqft">Square Feet *</label>
        <input
          type="number"
          id="newSqft"
          class="form-control"
          [(ngModel)]="newSqft"
          name="newSqft"
          required>
      </div>

      <div class="form-group">
        <label for="newImageUrl">Image URL</label>
        <input
          type="text"
          id="newImageUrl"
          class="form-control"
          [(ngModel)]="newImageUrl"
          name="newImageUrl">
      </div>

      <div class="form-group">
        <label for="newAmenity">Amenity</label>
        <input
          type="text"
          id="newAmenity"
          class="form-control"
          [(ngModel)]="newAmenity"
          name="newAmenity">
      </div>
    </form>
  </div>

  <div class="modal-footer">
    <button class="btn btn-secondary" (click)="closeCreateModal()">
      Cancel
    </button>
    <button class="btn btn-primary" (click)="createProperty()" [disabled]="!newName || !newRate || !newOccupancy || !newSqft">
      Create Property
    </button>
  </div>
</div>

<!-- Image Selector Modal Backdrop -->
<div class="modal-backdrop"
     *ngIf="isImageSelectorVisible"
     (click)="closeImageSelector()">
</div>

<!-- Image Selector Modal -->
<div class="modal-container image-selector-modal"
     *ngIf="isImageSelectorVisible"
     (click)="$event.stopPropagation()">

  <div class="modal-header">
    <h2 class="modal-title">Select Image</h2>
    <button class="close-button"
            (click)="closeImageSelector()"
            aria-label="Close">
      <span>&times;</span>
    </button>
  </div>

  <div class="modal-body">
    <div class="image-selector-grid">
      <div *ngFor="let folder of imageFolders" class="image-folder">
        <h3>{{ folder.name }}</h3>
        <div class="images-grid">
          <div *ngFor="let image of folder.images"
               class="image-item"
               (click)="selectImage(image.path)"
               [title]="image.filename">
            <img [src]="image.path" [alt]="image.filename" class="thumbnail">
            <p>{{ image.filename }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-footer">
    <button class="btn btn-secondary" (click)="closeImageSelector()">
      Cancel
    </button>
  </div>
</div>
